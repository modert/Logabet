<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <title>Logabet 2.0</title>

    <style>
        body{
            padding-top: 10px;
            font-family: sans-serif;
        }
        .col-centered{
            float: none;
            margin: auto;
        }
        .col-letter{
            width: 15%;
        }
    </style>
</head>
<body class="container">
    <div class="panel panel-success">
        <div class="panel-heading text-center">
            <h1>Logabet</h1>
        </div> 
    </div>
    <div class="panel panel-primary">
        <div class="panel-heading text-center">
            <h3>Type the letter below</h3>
        </div>
        <div class="panel-body text-center">
            <h1 id="letter" name="letter"></h1>
        </div>
        <div class="panel-body text-center">
            <h1 style="display:none;" id="validMessage" name="validMessage"></h1>
        </div>
        <div class="panel-body text-center">
            <input id="inputLetter" name="inputLetter" class="h1 col-letter text-center" autofocus="true" />
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading">
        Options
        </div>
        <div class="panel panel-body">
            <div class="checkbox checkbox-inline">
                <label>
                    <input id="lowLet" name="lowLet" type="checkbox" class="checkbox" checked="checked">Lowercase Letters
                </label>    
            </div>
            <div class="checkbox checkbox-inline">
                <label>
                    <input id="capLet" name="capLet" type="checkbox" class="checkbox">Capital Letters
                </label>    
            </div>
            <div class="checkbox checkbox-inline">
                <label>
                    <input id="nums" name="nums" type="checkbox" class="checkbox">Numbers
                </label>    
            </div>
        </div>
    </div>
        <div class="panel panel-default">
        <div class="panel-heading">
        Scoring
        </div>
        <div class="panel panel-body">
            <div class="checkbox checkbox-inline">
                <label>
                    <input id="caseSens" name="caseSens" type="checkbox" class="checkbox">
                    CaSe SenSiTiVe
                </label>    
            </div>
<!--             <div class="checkbox checkbox-inline">
                <label>
                    <input id="capLet" name="capLet" type="checkbox" class="checkbox">Capital Letters
                </label>    
            </div> -->
        </div>
    </div>
</body>
</html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.js" integrity="sha256-16cdPddA6VdVInumRGo6IbivbERE8p7CQR3HzTBuELA=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script>
    var alphaNumString;
    var letterToType;
    var timer;

    $(document).ready(function () {
        $listenForChangeToText();
        $listenForCheckbox();
        $updateAlphaNumString();
        $genRandomCharacter();
    });

    function $genRandomCharacter(){
        $('#letter').text(random_character());
    }

    function $listenForCheckbox() {
        $('input.checkbox').off().change(function(){
            $updateAlphaNumString()
        })
    }

    function $updateAlphaNumString() {
        var checkboxes = $('input.checkbox');
        alphaNumString = "";
        for(i=0;i < checkboxes.length; i++){

            if (checkboxes[i].checked === true){
                switch(checkboxes[i].id){
                    case 'nums':
                        alphaNumString = alphaNumString + "0123456789";
                    break;
                    case 'lowLet':
                        alphaNumString = alphaNumString + "abcdefghijklmnopqrstuvwxyz";
                    break;
                    case 'capLet':
                        alphaNumString = alphaNumString +  "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
                    break;
                    default:
                }
            }
        }
        $refocus();
    }

    function $listenForChangeToText(){
        $('#inputLetter').off().on('keyup touchend',function(){
            $checkResponseForCorrectAnswer(this);
        })
    }

    function $checkResponseForCorrectAnswer(element){
            var letter = $(element).val();
            if (letter === letterToType && $('#caseSens')[0].checked || letter.toString().toLowerCase() === letterToType.toString().toLowerCase() && !$('#caseSens')[0].checked){
                $updateMessage("Great Work!");
            }
            else if (letter != ''){
                $updateMessage(letter + " is incorrect.<br/>Please Try Again!", true);
            }
            $(element).attr("value","");
    }

    function $refocus(){
        $('#inputLetter').focus();
    }

    function $updateMessage(message, html){
        if (html){
        $('#validMessage').html(message).removeClass('alert-success').addClass('alert-danger').show();
        }
        else{
        $('#validMessage').text(message).removeClass('alert-danger').addClass('alert-success').show();      
        $genRandomCharacter();     
        }
        clearTimeout(timer);
        timer = setTimeout(function(){$('#validMessage').text('').html('').hide();},5000);
    }

    function random_character() {
    // var chars = "0123456789abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
    // chars = alphaNumString;
    letterToType = alphaNumString.substr( Math.floor(Math.random() * alphaNumString.length), 1);
    return letterToType;
}

</script>
